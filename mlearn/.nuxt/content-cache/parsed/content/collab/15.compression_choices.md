{"parsed":{"_path":"/collab/compression_choices","_dir":"collab","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Pickle compression comparison","description":"pickles are encoded binary files used by Python to store object state, which usually end up generating large files (in the order of gigabytes).  These files can be encoded","layout":"blog","navigation":{"title":"Pickle compression comparison"},"tags":"python,pickle,blosc2,gzip,pbz2,pandas,numpy,matplotlib,chatGPT","icon":"logos:python","cover":"/img/15.compression_choices_files/15.compression_choices_15_0.png","publicationDate":"20230501","author":"marcoalmeida.dev.br@gmail.com","published":true,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"pickle-compression-comparison"},"children":[{"type":"text","value":"Pickle compression comparison"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/pickle.html","rel":["nofollow"]},"children":[{"type":"text","value":"Python pickles"}]},{"type":"text","value":" are serialized representations of objects, generally stored as binary files."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"\"pickling\" refers to the process of converting a Python object into a stream of bytes, which can then be stored in a file or transferred over a network. This serialized form of the object can later be \"unpickled\" to recreate the original object"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Some common usages of pickles in machine learning:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"images, binary raw input or descriptor data"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"pre-trained models (numpy matrices, and pandas dataframes)"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Whatever each pickle might represent, real-world applications can yield "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"file sizes easily reaching the gigabyte mark, or even larger"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"some-reasons-to-compress"},"children":[{"type":"text","value":"Some Reasons to compress"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"to save provider charges by using a smaller and cheaper pod, with less memory and disk space."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"but you still care about performance, and want to get the least load overhead for the best compression ratio"}]}]},{"type":"element","tag":"h2","props":{"id":"contenders"},"children":[{"type":"text","value":"Contenders"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are several "},{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/archiving.html","rel":["nofollow"]},"children":[{"type":"text","value":"archiving algorithms options"}]},{"type":"text","value":" in Python."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The actual choice will depend on your circumstances."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's compare three popular algorithms"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/bz2.html","rel":["nofollow"]},"children":[{"type":"text","value":"bzip2"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/gzip.html","rel":["nofollow"]},"children":[{"type":"text","value":"gzip"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/Blosc/python-blosc2","rel":["nofollow"]},"children":[{"type":"text","value":"blosc2"}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Blosc is a high performance compressor optimized for binary data (i.e. floating point numbers, integers and booleans, although it can handle string data too)."}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"the code in this article is available from "},{"type":"element","tag":"a","props":{"href":"https://github.com/MarcoAAlmeida/sandbox/blob/main/pylearn/cpickle/02.compression_choices.ipynb","rel":["nofollow"]},"children":[{"type":"text","value":"this Jupyter notebook in my Github sandbox repo"}]}]}]},{"type":"element","tag":"code","props":{"code":"\r\nimport bz2, gzip, blosc2\r\nimport _pickle as cPickle\r\nimport pickle\r\nimport pandas\r\n\r\ndef load_plain(file):\r\n    with open(file, \"rb\") as f:\r\n      return cPickle.load(f)\r\n\r\ndef load_pandas(file):\r\n    df = pandas.read_csv(file)\r\n    return df\r\n\r\ndef dump_plain(file, data):\r\n    with open(file, \"wb\") as f:\r\n      return cPickle.dump(data,f)\r\n\r\n\r\ndef compress_pickle_b2z(file, data):\r\n    with bz2.BZ2File(file, 'wb') as f:\r\n        cPickle.dump(data, f)\r\n\r\ndef decompress_pickle_b2z(file):\r\n    data = bz2.BZ2File(file, 'rb')\r\n    return cPickle.load(data)\r\n\r\n\r\ndef decompress_pickle_gzip(file):\r\n    with open(file, 'rb') as f:\r\n        return cPickle.loads(gzip.decompress(f.read()))\r\n\r\ndef compress_pickle_gzip(file, data):\r\n    with open(file, 'wb') as f:\r\n        f.write(gzip.compress(cPickle.dumps(data)))\r\n\r\n\r\ndef decompress_pickle_blosc2(file):\r\n    with open(file, 'rb') as f:\r\n        return cPickle.loads(blosc2.decompress(f.read()))\r\n\r\ndef compress_pickle_blosc2(file, data):\r\n    blosc2.MAX_BUFFERSIZE = 8 * 1024 * 1024 * 1024\r\n    with open(file, 'wb') as f:\r\n        f.write(blosc2.compress(cPickle.dumps(data)))\r\n\r\n\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" bz2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" blosc2"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" _pickle "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" cPickle"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" pickle"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" pandas"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"load_plain"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"rb\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" cPickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"load"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(f)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"load_pandas"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    df "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" pandas"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"read_csv"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" df"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"dump_plain"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"wb\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"      "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" cPickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"dump"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data,f)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_b2z"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" bz2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"BZ2File"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'wb'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        cPickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"dump"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data, f)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_b2z"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    data "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" bz2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"BZ2File"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'rb'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" cPickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"load"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'rb'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" cPickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"loads"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(gzip."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(f."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"read"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'wb'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"write"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(gzip."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(cPickle."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"dumps"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data)))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_blosc2"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'rb'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" cPickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"loads"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(blosc2."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(f."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"read"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_blosc2"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    blosc2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-376a56"},"children":[{"type":"text","value":"MAX_BUFFERSIZE"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"1024"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"1024"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"1024"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"file"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'wb'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"write"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(blosc2."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(cPickle."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"dumps"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data)))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]}]}]}]},{"type":"element","tag":"h2","props":{"id":"datablist-around-16mb"},"children":[{"type":"text","value":"Datablist (around 16MB)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's download the ´customers-100000.csv´ file from "},{"type":"element","tag":"a","props":{"href":"https://github.com/datablist/sample-csv-files","rel":["nofollow"]},"children":[{"type":"text","value":"datablist github repo"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We'll turn the pandas frame into a pickle, then compress it with each algorithm."}]},{"type":"element","tag":"code","props":{"code":"df = pandas.read_csv('../data/datablist/customers-100000.csv')\r\ndump_plain('../data/datablist/customers-100000.pickle', df)\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"df "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" pandas"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"read_csv"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/datablist/customers-100000.csv'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"dump_plain"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/datablist/customers-100000.pickle'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", df)"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"inspecting-the-pickle"},"children":[{"type":"text","value":"Inspecting the pickle"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's inspect the generated pickle file with "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"picketools"}]},{"type":"text","value":"."}]},{"type":"element","tag":"code","props":{"code":"import pickletools\r\n\r\n\r\ndef inspect_pickle(pickle_path):\r\n    with open(pickle_path, 'rb') as f:\r\n       data = f.read()\r\n    pickletools.dis(data)\r\n\r\ninspect_pickle('../data/datablist/customers-100000.pickle')\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" pickletools"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"inspect_pickle"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"pickle_path"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(pickle_path, "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'rb'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"       data "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"read"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    pickletools"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"dis"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"inspect_pickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/datablist/customers-100000.pickle'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The inspection confirms it's indeed a Pandas DataFrame "},{"type":"element","tag":"icon","props":{"name":"simple-icons:smugmug"},"children":[]}]},{"type":"element","tag":"code","props":{"code":"    0: \\x80 PROTO      4\r\n    2: \\x95 FRAME      276\r\n   11: \\x8c SHORT_BINUNICODE 'pandas.core.frame'\r\n   30: \\x94 MEMOIZE    (as 0)\r\n   31: \\x8c SHORT_BINUNICODE 'DataFrame'\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    0: \\x80 PROTO      4\r\n    2: \\x95 FRAME      276\r\n   11: \\x8c SHORT_BINUNICODE 'pandas.core.frame'\r\n   30: \\x94 MEMOIZE    (as 0)\r\n   31: \\x8c SHORT_BINUNICODE 'DataFrame'"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"compressing-it"},"children":[{"type":"text","value":"Compressing it"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's compress with each algorithm."}]},{"type":"element","tag":"code","props":{"code":"train = load_plain('../data/datablist/customers-100000.pickle')\r\n\r\ncompress_pickle_b2z(\"../data/datablist/customers-100000.pbz2\", train)\r\ncompress_pickle_gzip(\"../data/datablist/customers-100000.gzip\", train)\r\ncompress_pickle_blosc2(\"../data/datablist/customers-100000.blosc2\", train)\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"train "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"load_plain"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/datablist/customers-100000.pickle'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_b2z"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/datablist/customers-100000.pbz2\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", train)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/datablist/customers-100000.gzip\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", train)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_blosc2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/datablist/customers-100000.blosc2\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", train)"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As with any other pickle, any of the three zipped files can be used to restore the original object."}]},{"type":"element","tag":"code","props":{"code":"df = decompress_pickle_gzip(\"../data/customers-100000.gzip\")\r\ndf.head()\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"df "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/customers-100000.gzip\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"df"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"head"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's record the decompression time overhead."}]},{"type":"element","tag":"code","props":{"code":"%timeit decompress_pickle_gzip(\"../data/datablist/customers-100000.gzip\")\r\n%timeit decompress_pickle_b2z(\"../data/datablist/customers-100000.pbz2\")\r\n%timeit decompress_pickle_blosc2(\"../data/datablist/customers-100000.blosc2\")\r\n\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/datablist/customers-100000.gzip\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_b2z"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/datablist/customers-100000.pbz2\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_blosc2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/datablist/customers-100000.blosc2\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/timeit.html#timeit.Timer.timeit","rel":["nofollow"]},"children":[{"type":"text","value":"%timeit is a tiny tool"}]},{"type":"text","value":" to measure execution times of snippets of Python code"}]}]},{"type":"element","tag":"h2","props":{"id":"visualizing-results"},"children":[{"type":"text","value":"Visualizing results"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now let's compare files sizes, and compression rates."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First a class to hold results:"}]},{"type":"element","tag":"code","props":{"code":"import os\r\n\r\nclass PerformanceStats:\r\n    def __init__(self, filename, method):\r\n        self.method = method\r\n        self.filename = filename\r\n        self.original = 0.0\r\n        self.compressed = 0.0\r\n        self.ratio = 1\r\n\r\n    def get_ratio(self):\r\n        pickle_path = f\"{self.filename}.pickle\"\r\n        file_path = f\"{self.filename}.{self.method}\"\r\n\r\n        return os.path.getsize(file_path)/os.path.getsize(pickle_path)\r\n    \r\n\r\n\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" os"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"__init__"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-71b192"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"filename"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"method"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"method "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" method"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"filename "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" filename"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"original "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"0.0"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"compressed "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"0.0"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"ratio "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-71b192"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        pickle_path "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"filename"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":".pickle\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        file_path "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"filename"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-5e4ad0"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"method"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" os"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"path"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"getsize"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(file_path)"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"os"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"path"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"getsize"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(pickle_path)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then plot the results:"}]},{"type":"element","tag":"code","props":{"code":"import matplotlib.pyplot as plt\r\n\r\ndef plot_performance_stats(df):\r\n    pivot_table = df.pivot_table(index='algorithm_name', values=['compression_ratio', 'execution_time'], aggfunc='mean')\r\n\r\n    fig, ax1 = plt.subplots(figsize=(10, 5))\r\n\r\n    bars = pivot_table['compression_ratio'].plot(kind='bar', ax=ax1, color='b')\r\n    ax1.set_ylabel('Compression Ratio', color='b')\r\n    ax1.tick_params('y', colors='b')\r\n\r\n    # Add actual values to bars\r\n    for i, v in enumerate(pivot_table['compression_ratio']):\r\n        ax1.text(i-0.2, v+0.02, str(round(v, 3)), color='black', fontsize=10)\r\n\r\n    ax2 = ax1.twinx()\r\n\r\n    pivot_table['execution_time'].plot(kind='line', ax=ax2, color='r', marker='o')\r\n    ax2.set_ylabel('Execution Time (seconds)', color='r')\r\n    ax2.tick_params('y', colors='r')\r\n\r\n    ax1.set_xlabel('Algorithm Name')\r\n    ax1.set_title('Compression Ratio and Execution Time by Algorithm')\r\n\r\n    # show the plot\r\n    plt.show()\r\n\r\n\r\n\r\ndata = {'compression_ratio': [\r\n            PerformanceStats('../data/datablist/customers-100000', 'gzip').get_ratio(),\r\n            PerformanceStats('../data/datablist/customers-100000', 'pbz2').get_ratio(), \r\n            PerformanceStats('../data/datablist/customers-100000', 'blosc2').get_ratio()],\r\n        'execution_time': [112, 499, 68.7],\r\n        'algorithm_name': ['gzip', 'pbz2', 'blosc2']}\r\n\r\nplot_performance_stats(pandas.DataFrame(data))\r\n\r\n\r\n\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" matplotlib"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"pyplot "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" plt"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"plot_performance_stats"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"df"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    pivot_table "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" df"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"pivot_table"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"index"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'algorithm_name'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"values"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'compression_ratio'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'execution_time'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"], "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"aggfunc"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'mean'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    fig"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ax1 "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" plt"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"subplots"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"figsize"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    bars "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" pivot_table"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'compression_ratio'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"]."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"plot"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"kind"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'bar'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"ax"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"ax1, "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"color"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'b'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    ax1"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"set_ylabel"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'Compression Ratio'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"color"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'b'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    ax1"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"tick_params"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'y'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"colors"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'b'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-16834c"},"children":[{"type":"text","value":"# Add actual values to bars"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" i"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" v "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"enumerate"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(pivot_table["}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'compression_ratio'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"]):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        ax1"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"text"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(i"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"0.2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", v"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"0.02"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-ad9373"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"round"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(v, "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"3"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")), "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"color"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'black'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"fontsize"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    ax2 "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ax1"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"twinx"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    pivot_table"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'execution_time'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"]."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"plot"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"kind"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'line'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"ax"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"ax2, "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"color"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'r'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"marker"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'o'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    ax2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"set_ylabel"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'Execution Time (seconds)'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"color"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'r'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    ax2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"tick_params"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'y'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-7a4289"},"children":[{"type":"text","value":"colors"}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'r'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    ax1"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"set_xlabel"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'Algorithm Name'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    ax1"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"set_title"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'Compression Ratio and Execution Time by Algorithm'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-16834c"},"children":[{"type":"text","value":"# show the plot"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    plt"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"show"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"data "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'compression_ratio'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/datablist/customers-100000'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'gzip'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/datablist/customers-100000'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'pbz2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(),"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/datablist/customers-100000'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'blosc2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'execution_time'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"112"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"499"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"68.7"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'algorithm_name'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'gzip'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'pbz2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'blosc2'"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"plot_performance_stats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(pandas."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"DataFrame"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"png","src":"/img/15.compression_choices_files/15.compression_choices_15_0.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"results-analysis"},"children":[{"type":"text","value":"Results Analysis"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That was an interesting result:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"blosc2 had best loading time, but worse compression rate"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"pbz2 was twice as efficent for compression, but ~10x slower"}]}]},{"type":"element","tag":"h1","props":{"id":"larger-pickles"},"children":[{"type":"text","value":"Larger pickles"}]},{"type":"element","tag":"h2","props":{"id":"failed-attempt"},"children":[{"type":"text","value":"Failed attempt"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Our first attempt of a large pickle file was too ambitious."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The pickle had about ~3GB\r\n"},{"type":"element","tag":"a","props":{"href":"https://www.kaggle.com/code/columbia2131/speed-up-reading-csv-to-pickle/input","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.kaggle.com/code/columbia2131/speed-up-reading-csv-to-pickle/input"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The blosc2 algorithm failed with "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"out of memory"}]},{"type":"text","value":" exception multiple times (even on a 32GB RAM machine)"}]},{"type":"element","tag":"h2","props":{"id":"globocom-news-interactions-pickle"},"children":[{"type":"text","value":"globo.com news interactions pickle"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's try with another pickle of about ~364MB"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.kaggle.com/datasets/gspmoreira/news-portal-user-interactions-by-globocom","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.kaggle.com/datasets/gspmoreira/news-portal-user-interactions-by-globocom"}]}]},{"type":"element","tag":"code","props":{"code":"def compress_multiple(file_path):\r\n    train = load_plain(f'{file_path}.pickle')\r\n\r\n    compress_pickle_blosc2(f'{file_path}.blosc2', train)\r\n    compress_pickle_b2z(f'{file_path}.pbz2', train)\r\n    compress_pickle_gzip(f'{file_path}.gzip', train)\r\n\r\ncompress_multiple('../data/globo.com/articles_embeddings')\r\n\r\n\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_multiple"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"file_path"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    train "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"load_plain"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"file_path"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":".pickle'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_blosc2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"file_path"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":".blosc2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", train)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_b2z"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"file_path"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":".pbz2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", train)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_pickle_gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"file_path"}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":".gzip'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", train)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_multiple"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/globo.com/articles_embeddings'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's record the decompression times"}]},{"type":"element","tag":"code","props":{"code":"%timeit decompress_pickle_gzip(\"../data/globo.com/articles_embeddings.gzip\")\r\n%timeit decompress_pickle_b2z(\"../data/globo.com/articles_embeddings.pbz2\")\r\n%timeit decompress_pickle_blosc2(\"../data/globo.com/articles_embeddings.blosc2\")\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/globo.com/articles_embeddings.gzip\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_b2z"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/globo.com/articles_embeddings.pbz2\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_blosc2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/globo.com/articles_embeddings.blosc2\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"\r\ndata = {'compression_ratio': [\r\n            PerformanceStats('../data/globo.com/articles_embeddings', 'gzip').get_ratio(),\r\n            PerformanceStats('../data/globo.com/articles_embeddings', 'pbz2').get_ratio(), \r\n            PerformanceStats('../data/globo.com/articles_embeddings', 'blosc2').get_ratio()],\r\n        'execution_time': [1750, 15500, 213],\r\n        'algorithm_name': ['gzip', 'pbz2', 'blosc2']}\r\n\r\nplot_performance_stats(pandas.DataFrame(data))\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"data "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'compression_ratio'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/globo.com/articles_embeddings'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'gzip'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/globo.com/articles_embeddings'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'pbz2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(),"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/globo.com/articles_embeddings'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'blosc2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'execution_time'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"1750"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"15500"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"213"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'algorithm_name'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'gzip'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'pbz2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'blosc2'"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"plot_performance_stats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(pandas."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"DataFrame"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data))"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"png","src":"/img/15.compression_choices_files/15.compression_choices_20_0.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The first thing to notice are the small compression rates."}]},{"type":"element","tag":"code","props":{"code":"data[\"compression_ratio\"]\r\n[0.9201726782856429, 0.9306057770322468, 0.9963305194058056]\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"data[\"compression_ratio\"]\r\n[0.9201726782856429, 0.9306057770322468, 0.9963305194058056]"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"blosc2 offered almost no compression at all (less than ~1%), while pbz2 had ~7%, and gzip only a little better (~8%)."}]},{"type":"element","tag":"code","props":{"code":"inspect_pickle(\"../data/globo.com/articles_embeddings.pickle\")\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"inspect_pickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/globo.com/articles_embeddings.pickle\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Inspection of the original pickle shows it's a "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"numpy ndarray"}]},{"type":"text","value":", which was probably already compressed in the original source."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sometimes compression "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"only adds overhead for loading times"}]},{"type":"text","value":", without any major gains in disk space."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This is clearly a case "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"where compression would not recommended"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h1","props":{"id":"wiki-news"},"children":[{"type":"text","value":"wiki-news"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.kaggle.com/datasets/correctoryui/fasttext-wikinews","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.kaggle.com/datasets/correctoryui/fasttext-wikinews"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This is a larger pickle, with about ~1.25GB"}]},{"type":"element","tag":"code","props":{"code":"import pickletools\r\n\r\ndef inspect_pickle(pickle_path, num_bytes=100):\r\n    with open(pickle_path, 'rb') as f:\r\n        data = f.read(num_bytes)\r\n    try:\r\n        pickletools.dis(data)\r\n\r\n    except Exception:\r\n        print(\"short-circuited for huge files\")\r\n\r\n    \r\ninspect_pickle('../data/wiki-news/wiki-news-300d-1M.pickle', 1000)\r\n\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" pickletools"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"inspect_pickle"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"pickle_path"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-abf1c8"},"children":[{"type":"text","value":"num_bytes"}]},{"type":"element","tag":"span","props":{"class":"ct-c45a9a"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"100"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(pickle_path, "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'rb'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        data "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" f"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"read"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(num_bytes)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"try"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        pickletools"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"dis"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-11a9b8"},"children":[{"type":"text","value":"except"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f62bc7"},"children":[{"type":"text","value":"Exception"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-0d97a8"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"short-circuited for huge files\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"    "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"inspect_pickle"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/wiki-news/wiki-news-300d-1M.pickle'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"1000"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Inspection of the pickle indicates that the class is a "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"gensim.models.keyedvectors Word2VecKeyedVectors"}]},{"type":"text","value":" which is part of "},{"type":"element","tag":"a","props":{"href":"/libs/python/gensim"},"children":[{"type":"text","value":"gensim module"}]}]},{"type":"element","tag":"code","props":{"code":"pip install gensim\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"pip install gensim"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"\r\ncompress_multiple('../data/wiki-news/wiki-news-300d-1M')\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"compress_multiple"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/wiki-news/wiki-news-300d-1M'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A quick inspection of the generated file indicates better compression rates, let's record the loading times"}]},{"type":"element","tag":"code","props":{"code":"%timeit decompress_pickle_gzip(\"../data/wiki-news/wiki-news-300d-1M.gzip\")\r\n%timeit decompress_pickle_b2z(\"../data/wiki-news/wiki-news-300d-1M.pbz2\")\r\n%timeit decompress_pickle_blosc2(\"../data/wiki-news/wiki-news-300d-1M.blosc2\")\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_gzip"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/wiki-news/wiki-news-300d-1M.gzip\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_b2z"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/wiki-news/wiki-news-300d-1M.pbz2\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"timeit "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"decompress_pickle_blosc2"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"\"../data/wiki-news/wiki-news-300d-1M.blosc2\""}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"5.47 s ± 70.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\r\n36.2 s ± 526 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\r\n1.37 s ± 57.8 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"5.47 s ± 70.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\r\n36.2 s ± 526 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\r\n1.37 s ± 57.8 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)"}]}]}]}]}]},{"type":"element","tag":"code","props":{"code":"data = {'compression_ratio': [\r\n            PerformanceStats('../data/wiki-news/wiki-news-300d-1M', 'gzip').get_ratio(),\r\n            PerformanceStats('../data/wiki-news/wiki-news-300d-1M', 'pbz2').get_ratio(), \r\n            PerformanceStats('../data/wiki-news/wiki-news-300d-1M', 'blosc2').get_ratio()],\r\n        'execution_time': [1750, 15500, 213],\r\n        'algorithm_name': ['gzip', 'pbz2', 'blosc2']}\r\n\r\nplot_performance_stats(pandas.DataFrame(data))\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"data "}]},{"type":"element","tag":"span","props":{"class":"ct-88f1dc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'compression_ratio'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/wiki-news/wiki-news-300d-1M'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'gzip'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/wiki-news/wiki-news-300d-1M'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'pbz2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(),"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"PerformanceStats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'../data/wiki-news/wiki-news-300d-1M'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'blosc2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"get_ratio"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'execution_time'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"1750"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"15500"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-65baef"},"children":[{"type":"text","value":"213"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'algorithm_name'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'gzip'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'pbz2'"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-92a647"},"children":[{"type":"text","value":"'blosc2'"}]},{"type":"element","tag":"span","props":{"class":"ct-7925fe"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"plot_performance_stats"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(pandas."}]},{"type":"element","tag":"span","props":{"class":"ct-90c543"},"children":[{"type":"text","value":"DataFrame"}]},{"type":"element","tag":"span","props":{"class":"ct-398878"},"children":[{"type":"text","value":"(data))"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"png","src":"/img/15.compression_choices_files/15.compression_choices_30_0.png"},"children":[]}]},{"type":"element","tag":"h3","props":{"id":"result-analysis"},"children":[{"type":"text","value":"Result analysis"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The same pattern still applies, with almost no compression from blosc2."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If some compression is desired, than "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"gzip"}]},{"type":"text","value":" would give good compression without too much overhead."}]},{"type":"element","tag":"h1","props":{"id":"conclusion"},"children":[{"type":"text","value":"Conclusion"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Things to keep in mind:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"any compression will add loading overhead"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"if you care more about short loading times, then use "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"blosc2"}]},{"type":"text","value":".  If you're lucky, you'll get some compression, depending on the nature of the original pickle"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"if you only care about small size, then use "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"pbz2"}]},{"type":"text","value":".  But be ready to increase your loading overhead by about 10x"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"gzip"}]},{"type":"text","value":" usually gives a more balanced trade-off"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I hope this gives you some food for thought, or hopefully a head start for some further analysis."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Either way, please let me know.  "},{"type":"element","tag":"icon","props":{"name":"simple-icons:smugmug"},"children":[]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-f62bc7{color:#79B8FF}\n.ct-c45a9a{color:#F97583}\n.ct-ad9373{color:#79B8FF}\n.ct-16834c{color:#6B737C}\n.ct-71b192{color:#FF9800}\n.ct-5e4ad0{color:#B392F0}\n.ct-65baef{color:#F8F8F8}\n.ct-376a56{color:#B392F0}\n.ct-88f1dc{color:#F97583}\n.ct-92a647{color:#FFAB70}\n.ct-7a4289{color:#BBBBBB}\n.ct-0d97a8{color:#B392F0}\n.ct-abf1c8{color:#FF9800}\n.ct-90c543{color:#B392F0}\n.ct-398878{color:#BBBBBB}\n.ct-7925fe{color:#B392F0}\n.ct-11a9b8{color:#F97583}\n.dark .ct-11a9b8{color:#F97583}\n.sepia .ct-11a9b8{color:#C678DD}\n.dark .ct-7925fe{color:#B392F0}\n.sepia .ct-7925fe{color:#ABB2BF}\n.dark .ct-398878{color:#BBBBBB}\n.sepia .ct-398878{color:#ABB2BF}\n.dark .ct-90c543{color:#B392F0}\n.sepia .ct-90c543{color:#61AFEF}\n.dark .ct-abf1c8{color:#FF9800}\n.sepia .ct-abf1c8{color:#D19A66}\n.dark .ct-0d97a8{color:#B392F0}\n.sepia .ct-0d97a8{color:#56B6C2}\n.dark .ct-7a4289{color:#BBBBBB}\n.sepia .ct-7a4289{color:#E06C75}\n.dark .ct-92a647{color:#FFAB70}\n.sepia .ct-92a647{color:#98C379}\n.dark .ct-88f1dc{color:#F97583}\n.sepia .ct-88f1dc{color:#56B6C2}\n.dark .ct-376a56{color:#B392F0}\n.sepia .ct-376a56{color:#D19A66}\n.dark .ct-65baef{color:#F8F8F8}\n.sepia .ct-65baef{color:#D19A66}\n.dark .ct-5e4ad0{color:#B392F0}\n.sepia .ct-5e4ad0{color:#E5C07B}\n.dark .ct-71b192{color:#FF9800}\n.sepia .ct-71b192{color:#E5C07B}\n.dark .ct-16834c{color:#6B737C}\n.sepia .ct-16834c{color:#7F848E}\n.dark .ct-ad9373{color:#79B8FF}\n.sepia .ct-ad9373{color:#56B6C2}\n.dark .ct-c45a9a{color:#F97583}\n.sepia .ct-c45a9a{color:#ABB2BF}\n.dark .ct-f62bc7{color:#79B8FF}\n.sepia .ct-f62bc7{color:#ABB2BF}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"some-reasons-to-compress","depth":2,"text":"Some Reasons to compress"},{"id":"contenders","depth":2,"text":"Contenders"},{"id":"datablist-around-16mb","depth":2,"text":"Datablist (around 16MB)","children":[{"id":"inspecting-the-pickle","depth":3,"text":"Inspecting the pickle"},{"id":"compressing-it","depth":3,"text":"Compressing it"}]},{"id":"visualizing-results","depth":2,"text":"Visualizing results"},{"id":"results-analysis","depth":2,"text":"Results Analysis"},{"id":"failed-attempt","depth":2,"text":"Failed attempt"},{"id":"globocom-news-interactions-pickle","depth":2,"text":"globo.com news interactions pickle","children":[{"id":"result-analysis","depth":3,"text":"Result analysis"}]}]}},"_type":"markdown","_id":"content:collab:15.compression_choices.md","_source":"content","_file":"collab/15.compression_choices.md","_extension":"md"},"hash":"LppgR5bNfW"}